# Prometheus exporter для Nimble SRT

Prometheus exporter - это приложение для экспорта данных по протоколу [Nimble SRT (Secure Reliable Transport)](https://softvelum.com/nimble/srt/) в систему мониторинга [Prometheus](https://github.com/prometheus/prometheus).
Оно позволяет пользовательскому приложению получать статистику для каждого сокета **SRT** и отправлять эти данные в **Prometheus** в виде метрик по запросу.

## Предварительные требования

Для установки и запуска приложения в среде должны быть установлены:

* [`Go`](https://go.dev/doc/install) версии 1.19 или выше
* [`github.com/sirupsen/logrus`](github.com/sirupsen/logrus) версии 1.9.0 или выше

## Установка приложения

Чтобы установить приложение, клонируйте [репозиторий](https://github.com/deckhouse/nimble_exporter), перейдите в его корневую директорию и запустите сборку стандартными средствами **Go**.

```sh
# Клонируем репозиторий
git clone https://github.com/deckhouse/nimble_exporter

# Переходим в корневую директорию
cd nimble_exporter

# Запускаем сборку Go
go build
```

В результате сборки:
* в операционной системе **Windows** в корневой директории будет создан файл `nimble-exporter.exe`
* в операционных системах **Linux** или **Mac** в корневой директории будет создан исполняемый файл `nimble-exporter`

## Запуск приложения

Запустите приложение из командной строки (в любой ОС):

```sh
# Запускаем приложение
nimble-exporter
```

### Запуск приложения с параметрами

Вы можете задать следующие параметры при запуске:
* `auth_hash` — хеш-код аутентификации для Nimble
    * Формат: `текстовая строка`
    * По умолчанию: `""`
* `auth_salt` — "соль" аутентификации для Nimble
    * Формат: `текстовая строка`
    * По умолчанию: `""`
* `listen` — прослушиваемый порт
    * Формат: `текстовая строка`
    * По умолчанию: `":9017"`
* `nimble` — адрес для Nimble
    * Формат: `текстовая строка`
    * По умолчанию: `"http://127.0.0.1:8082"`
* `logfmt` — выбор формата для лога
    * Формат: `"normal" | "json"`
    * По умолчанию: `"json"`
* `loglevel` — выбор уровня лога
    * Формат: `текстовая строка`
    * По умолчанию: `"info"`

Пример запуска с параметрами:
```sh
# Запускаем приложение с параметрами
nimble-exporter -auth_hash=xxxx -auth_salt=590 -listen=:9017 -nimble=http://127.0.0.1:8082 -logfmt=normal -loglevel=info
```
